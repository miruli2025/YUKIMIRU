# 产品需求文档 (PRD)
# 日本滑雪场情况看板 — SkiDash Japan

**版本**: v1.0  
**作者**: Product Manager  
**创建日期**: 2026-02-14  
**最后更新**: 2026-02-14  

---

## 目录

1. [项目概述](#1-项目概述)
2. [目标用户](#2-目标用户)
3. [核心功能](#3-核心功能)
4. [数据维度定义](#4-数据维度定义)
5. [数据来源与采集方案](#5-数据来源与采集方案)
6. [版本规划](#6-版本规划)
7. [推荐算法](#7-推荐算法)
8. [页面与交互设计](#8-页面与交互设计)
9. [技术栈建议](#9-技术栈建议)
10. [非功能需求](#10-非功能需求)
11. [风险与待定事项](#11-风险与待定事项)

---

## 1. 项目概述

### 1.1 背景

住在东京的滑雪爱好者在周末出行时，需要综合考量天气、雪况、交通、价格等多项因素来决定去哪个滑雪场。目前这些信息分散在多个网站，没有一个统一的看板来对比和推荐。

### 1.2 产品定位

一个**日本滑雪场综合情况看板网站**，聚合多维度数据，帮助用户快速了解多个滑雪场在指定日期的综合状况，并通过算法推荐当天最值得去的滑雪场。

### 1.3 核心价值

- **一站式对比**: 在一个页面查看所有目标滑雪场的关键指标
- **智能推荐**: 基于综合评分自动推荐最佳选择
- **节省决策时间**: 从"花 30 分钟翻 5 个网站"到"打开一个页面 1 分钟搞定"

---

## 2. 目标用户

| 阶段 | 用户画像 | 特征 |
|------|---------|------|
| V1 | 个人使用（住在东京的滑雪爱好者） | 自驾出行，周末/假日滑雪，关注性价比 |
| V2 | 关东地区滑雪爱好者 | 扩大到关东地区用户，支持不同出发地 |
| V3 | 所有在日本的滑雪爱好者/游客 | 包括外国游客，多语言支持 |

---

## 3. 核心功能

### 3.1 功能列表

| ID | 功能 | 版本 | 优先级 |
|----|------|------|--------|
| F01 | 选择日期查看各滑雪场情况 | V1 | P0 |
| F02 | 滑雪场综合评分与排名 | V1 | P0 |
| F03 | 滑雪场数据对比看板 | V1 | P0 |
| F04 | 推荐当天最佳滑雪场 | V1 | P0 |
| F05 | 评分权重自定义 | V2 | P1 |
| F06 | 收藏/关注滑雪场 | V2 | P1 |
| F07 | 多出发地点支持 | V2 | P1 |
| F08 | 历史数据查看与趋势 | V2 | P2 |
| F09 | 用户评论/实时状况上报 | V3 | P2 |
| F10 | 多语言支持（日/英/中） | V3 | P2 |
| F11 | 移动端 PWA | V2 | P1 |
| F12 | 周末出行计划推荐（含住宿） | V3 | P3 |

---

## 4. 数据维度定义

### 4.1 数据维度总览

按类别分组，标注优先级和版本归属。

#### 🌨️ A. 雪况数据

| 维度 | 说明 | 优先级 | 版本 | 数据来源 |
|------|------|--------|------|----------|
| 新雪量 (cm) | 过去 24h / 48h / 72h 新降雪量 | **P0** | V1 | Snow-Forecast |
| 积雪深度 (cm) | 当前山顶/山腰/山脚积雪 | **P0** | V1 | Snow-Forecast |
| 降雪预报 (cm) | 未来 1-3 天预计降雪 | **P0** | V1 | Snow-Forecast |
| 雪质 | 粉雪/压实雪/湿雪/冰面 | **P1** | V2 | Snow-Forecast + 算法推断 |

#### 🌡️ B. 天气与环境

| 维度 | 说明 | 优先级 | 版本 | 数据来源 |
|------|------|--------|------|----------|
| 温度 (°C) | 山顶/山腰/山脚 三个海拔的温度 | **P0** | V1 | Snow-Forecast |
| 体感温度 (°C) | 考虑风速的体感温度 | **P1** | V1 | 计算得出 |
| 风速 (km/h) | 山顶/山腰风速 | **P0** | V1 | Snow-Forecast |
| 天气状况 | 晴/多云/雪/雨 等 | **P0** | V1 | Snow-Forecast |
| 能见度 | 良好/一般/差 | **P1** | V2 | Snow-Forecast |
| 冻雨风险 | 零度层高度 (freezing level) | **P1** | V1 | Snow-Forecast |
| 海拔 (m) | 山顶/山脚海拔 | **P0** | V1 | 静态数据 |

#### 🎿 C. 雪道与设施

| 维度 | 说明 | 优先级 | 版本 | 数据来源 |
|------|------|--------|------|----------|
| 雪道开放率 (%) | 当日开放雪道比例 | **P0** | V1 | 官网/Slope 平台 |
| 缆车运行状况 | 运行中/暂停/关闭 | **P1** | V2 | 官网 |
| 雪道总数 & 难度分布 | 初级/中级/高级比例 | **P1** | V1 | 静态数据 (Slope) |
| 最长雪道 (km) | 最长连续雪道长度 | **P2** | V2 | 静态数据 |
| 雪场面积 (ha) | 可滑行总面积 | **P2** | V2 | 静态数据 |
| 夜场开放 | 是否有夜场及时间 | **P0** | V1 | 官网/静态数据 |
| 公园/地形公园 | 是否有跳台、Rail 等 | **P2** | V3 | 静态数据 |

#### 🚗 D. 交通

| 维度 | 说明 | 优先级 | 版本 | 数据来源 |
|------|------|--------|------|----------|
| 车程时间 (分钟) | 从东京出发的预估驾车时间 | **P0** | V1 | Google Maps API |
| 车程距离 (km) | 从东京出发的距离 | **P1** | V1 | Google Maps API |
| 高速费用 (日元) | ETC 通行费预估 | **P1** | V2 | 静态数据/API |
| 道路状况 | 是否需要雪链/冬胎 | **P1** | V2 | 道路情报 |
| 停车场状况 | 有无/费用/是否容易满 | **P1** | V2 | 官网/静态数据 |
| 公共交通 | 新干线/巴士可达性及时间 | **P2** | V3 | 静态数据 |

#### 💰 E. 费用

| 维度 | 说明 | 优先级 | 版本 | 数据来源 |
|------|------|--------|------|----------|
| 雪票价格 (日元) | 1 日券成人价格 | **P0** | V1 | 官网/静态数据 |
| 半日券价格 | 半天价格 | **P2** | V2 | 官网/静态数据 |
| 夜场票价格 | 夜场票价 | **P1** | V2 | 官网/静态数据 |
| 早割/优惠信息 | 是否有早鸟折扣 | **P2** | V3 | 官网 |
| 综合出行成本 | 雪票 + 高速 + 油费估算 | **P1** | V2 | 计算得出 |

#### 👥 F. 拥挤度

| 维度 | 说明 | 优先级 | 版本 | 数据来源 |
|------|------|--------|------|----------|
| 预测拥挤度 | 基于日期类型（工作日/周末/假日）预测 | **P1** | V1 | 算法推断 |
| 实时拥挤度 | Google Maps 热门时段数据 | **P2** | V3 | Google Maps |

---

## 5. 数据来源与采集方案

### 5.1 Snow-Forecast.com

**可获取数据**（每个滑雪场提供 3 个海拔层的 6 天预报）：

| 数据项 | 格式 | 更新频率 |
|--------|------|----------|
| 降雪量预报 (cm) | 每 3 小时分段 | 每日 4 次 |
| 温度 (°C) | 山顶/山腰/山脚 | 每日 4 次 |
| 风速 (km/h) + 风向 | 山顶/山腰/山脚 | 每日 4 次 |
| 天气概况 (icon) | 晴/云/雪/雨 | 每日 4 次 |
| 零度层高度 (m) | 数值 | 每日 4 次 |
| 降水量 (mm) | 数值 | 每日 4 次 |
| 积雪深度 | 上次/下次报告 | 不定期 |

**采集方式**: 网页爬虫（HTML 解析），URL 模式: `https://www.snow-forecast.com/resorts/{resort-slug}/6day/mid`

> ⚠️ Snow-Forecast 无公开 API，需通过爬虫获取。注意遵守 robots.txt 和合理请求频率。

### 5.2 Slope 平台 / 滑雪场官网

- 雪道数量、难度分布、雪场面积等**静态数据**：手动收集一次，存入数据库
- 雪道开放率：部分官网有实时数据，可定期爬取

### 5.3 Google Maps API

- **Directions API**: 获取驾车时间和距离
- **注意**: V1 可用静态数据（非高峰平均时间），V2 再接入实时 API

### 5.4 静态/手动数据

以下数据变化频率低，V1 手动维护即可：

- 滑雪场基本信息（海拔、面积、雪道数）
- 雪票价格（按季更新）
- 夜场信息
- 停车场信息

---

## 6. 版本规划

### 6.1 V1 — MVP（4-6 周）

**目标**: 个人可用，核心功能跑通

**覆盖滑雪场** (22 个关东周边热门):
- 越后汤泽 (GALA / 苗场 / 神乐 / 神立 / 石打丸山 / 舞子)
- 白马地区 (白马八方尾根 / 白马五竜 / 白马47)
- 志贺高原 (横手山 / 焼額山·奥志贺 / 一の瀬)
- 野泽温泉
- 草津温泉
- 丸沼高原 / 川場 / 嬬恋
- 水上地区 (宝台树 / 谷川岳天神平)
- 菅平高原
- 轻井泽 Prince
- 富士天

**功能范围**:
- [x] 日期选择器（今天 ~ 未来 5 天）
- [x] 看板页面：表格展示所有滑雪场的核心指标
- [x] 综合评分排名（默认权重）
- [x] 数据维度: 新雪量、积雪、降雪预报、温度、风速、天气、海拔、车程、雪票价格、夜场、雪道开放率、雪道难度分布
- [x] 拥挤度预测（基于日期类型的简单规则）
- [x] 数据自动采集（Snow-Forecast 爬虫，每日 2-4 次）
- [x] 响应式布局（桌面优先，移动端可用）

**数据存储**: 静态数据 JSON/YAML + 爬虫数据缓存

### 6.2 V2 — 增强版（V1 后 4-8 周）

**目标**: 可以分享给朋友使用

- [ ] 评分权重自定义（滑块调整各维度权重）
- [ ] 收藏/关注滑雪场
- [ ] 多出发地支持（自定义出发地）
- [ ] 高速费用估算
- [ ] 道路状况集成
- [ ] 综合出行成本计算
- [ ] 缆车运行状况
- [ ] 更多票价信息（半日、夜场、早割）
- [ ] PWA 支持
- [ ] 历史数据趋势图
- [ ] 能见度数据
- [ ] 用户登录/偏好保存

### 6.3 V3 — 公开版

**目标**: 面向公众

- [ ] 多语言（日/英/中）
- [ ] 用户评价与实时上报
- [ ] 更多滑雪场覆盖（北海道、东北、关西）
- [ ] Google Maps 实时拥挤度
- [ ] 公共交通方案
- [ ] 周末出行计划推荐
- [ ] 地形公园信息
- [ ] SEO 优化
- [ ] 社交分享

---

## 7. 推荐算法

### 7.1 综合评分模型

采用**加权评分模型**，每个维度归一化到 0-100 分后加权求和。

```
总分 = Σ (维度分数_i × 权重_i)
```

### 7.2 V1 评分维度与默认权重

| 维度 | 权重 | 评分逻辑 |
|------|------|----------|
| 新雪量 | **25%** | 0cm=0分, 5cm=50分, 15cm+=100分（线性插值）|
| 天气舒适度 | **20%** | 综合温度 + 风速 + 天气状况 |
| 雪道开放率 | **15%** | 线性映射: 100%=100分, 0%=0分 |
| 积雪深度 | **10%** | 基于同期相对值排名 |
| 交通便利性 | **15%** | 车程时间: <2h=100, 2-3h=70, 3-4h=40, >4h=20 |
| 性价比 | **10%** | 雪票价格反向映射 |
| 拥挤度 | **5%** | 越不拥挤分越高 |

### 7.3 天气舒适度子评分

```
天气舒适度 = 温度分(40%) + 风速分(30%) + 天气分(30%)

温度分: -5~-10°C 最佳(100), <-15°C 或 >0°C 较差(30)
风速分: <15km/h=100, 15-30=70, 30-50=40, >50=10
天气分: 晴=100, 多云=80, 小雪=90, 大雪=50, 雨=10
```

### 7.4 拥挤度预测规则 (V1)

| 日期类型 | 拥挤度系数 | 说明 |
|----------|-----------|------|
| 工作日 | 低 (90分) | 人少 |
| 普通周末 | 中 (60分) | 一般拥挤 |
| 三连休 | 高 (30分) | 很挤 |
| 年末年始/春节 | 极高 (10分) | 非常挤 |

> 补充: 结合滑雪场规模（面积/缆车运力）调整，大型场地拥挤度系数上调。

### 7.5 特殊规则

- **降雨警告**: 如果山脚温度 > 0°C 且有降水 → 红色警告，评分大幅下调
- **强风警告**: 如果山顶风速 > 50km/h → 缆车可能停运，标注警告
- **粉雪加成**: 新雪 > 20cm + 温度 < -5°C → "Powder Day" 标记，额外加分

### 7.6 V2 权重自定义

用户可通过滑块调整各维度权重（0-100%），系统自动归一化。预设模板:

- **粉雪猎人**: 新雪量 40%, 积雪 15%, 天气 15%, 其他减少
- **佛系休闲**: 天气舒适度 30%, 交通 25%, 性价比 20%
- **硬核玩家**: 雪道开放率 25%, 雪道难度 20%, 新雪 25%

---

## 8. 页面与交互设计

### 8.1 页面结构

```
/ (首页/看板)
├── 日期选择器 (顶部)
├── 推荐卡片 (TOP 3 推荐，突出展示)
├── 滑雪场对比表格 (所有滑雪场，可排序)
└── 筛选/过滤条件

/resort/:id (滑雪场详情页)
├── 6天预报详情
├── 基本信息
└── 地图/交通信息
```

### 8.2 看板主页布局

```
┌─────────────────────────────────────────────┐
│  📅 日期: [2026-02-15 ▼]     SkiDash Japan  │
├─────────────────────────────────────────────┤
│  🏆 今日推荐                                 │
│  ┌──────┐ ┌──────┐ ┌──────┐                │
│  │ #1   │ │ #2   │ │ #3   │                │
│  │苗场   │ │白马47│ │神乐  │                │
│  │⭐92分 │ │⭐88分│ │⭐85分│                │
│  │🌨20cm │ │🌨15cm│ │🌨18cm│                │
│  │🚗2.5h │ │🚗3.5h│ │🚗2.5h│                │
│  └──────┘ └──────┘ └──────┘                │
├─────────────────────────────────────────────┤
│  📊 全部滑雪场                               │
│  名称 | 评分 | 新雪 | 积雪 | 温度 | 风速 |  │
│       | 天气 | 开放率| 车程 | 票价 | 夜场 |  │
│  ─────────────────────────────────────────  │
│  苗场  | 92  | 20cm | 180 | -8°C | 15   |  │
│  ...   | ... | ...  | ... | ...  | ...  |  │
└─────────────────────────────────────────────┘
```

### 8.3 交互要点

- 表格列可点击排序
- 鼠标悬停显示详细信息
- 颜色编码: 绿(优) / 黄(中) / 红(差) 直观表示各指标状态
- 点击滑雪场名进入详情页

---

## 9. 技术栈建议

### 9.1 V1 推荐技术栈

考虑到 V1 是个人项目，追求**开发速度**和**低运维成本**:

| 层级 | 技术 | 理由 |
|------|------|------|
| **前端** | Next.js 14+ (App Router) | SSR/SSG、React 生态、部署方便 |
| **UI** | Tailwind CSS + shadcn/ui | 快速开发、美观 |
| **后端/API** | Next.js API Routes | 前后端一体，减少复杂度 |
| **数据库** | SQLite (via Drizzle ORM) | 轻量级、无需外部服务 |
| **爬虫** | Node.js + Cheerio | 解析 Snow-Forecast HTML |
| **定时任务** | Cron (Vercel Cron / node-cron) | 定时爬取数据 |
| **部署** | Vercel (免费 tier) | 零运维、自动部署 |
| **数据缓存** | 文件系统 JSON / SQLite | 简单高效 |

### 9.2 V2+ 扩展考虑

| 需求 | 技术升级 |
|------|----------|
| 用户系统 | NextAuth.js |
| 数据库扩展 | PostgreSQL (Supabase/Neon) |
| 实时交通数据 | Google Maps Directions API |
| 推送通知 | Web Push / LINE Bot |
| 监控 | Sentry + Vercel Analytics |

### 9.3 项目结构

```
ski-dash/
├── src/
│   ├── app/                  # Next.js App Router
│   │   ├── page.tsx          # 首页看板
│   │   ├── resort/[id]/      # 详情页
│   │   └── api/              # API Routes
│   ├── lib/
│   │   ├── scraper/          # 爬虫模块
│   │   │   └── snow-forecast.ts
│   │   ├── scoring/          # 评分算法
│   │   │   └── recommend.ts
│   │   ├── db/               # 数据库
│   │   └── types/            # 类型定义
│   ├── components/           # UI 组件
│   └── data/                 # 静态数据 (滑雪场基础信息)
│       └── resorts.yaml
├── scripts/
│   └── fetch-data.ts         # 数据采集脚本
└── drizzle/                  # DB schema & migrations
```

---

## 10. 非功能需求

| 需求 | V1 目标 | V2+ 目标 |
|------|---------|----------|
| 页面加载 | < 2s | < 1s (SSG) |
| 数据新鲜度 | 6 小时内 | 3 小时内 |
| 可用性 | 99% (个人使用) | 99.5% |
| 移动端适配 | 可用 | 优秀 (PWA) |
| 爬虫稳定性 | 失败重试 + 告警 | 多数据源 fallback |
| SEO | 不需要 | V3 需要 |

---

## 11. 风险与待定事项

### 11.1 风险

| 风险 | 影响 | 缓解方案 |
|------|------|----------|
| Snow-Forecast 页面结构变更 | 爬虫失效 | 爬虫模块解耦，便于快速修复；加入监控告警 |
| Snow-Forecast 封 IP | 无法获取数据 | 合理频率 (每 6h)；缓存数据；备选数据源 (OpenWeather) |
| 雪道开放率数据难以自动获取 | 核心指标缺失 | V1 手动更新或设为可选；V2 探索自动化 |
| Google Maps API 费用 | 成本上升 | V1 使用静态车程数据；V2 按需调用 + 缓存 |

### 11.2 待定事项

- [ ] 确认 Snow-Forecast 的 URL slug 格式（需实际测试各滑雪场）
- [ ] V1 滑雪场列表最终确认
- [ ] 推荐算法权重需实际使用后调优
- [ ] 是否需要 LINE Bot 推送功能（V2 考虑）

---

## 附录 A: V1 目标滑雪场列表 (草案)

| # | 滑雪场 | 地区 | 预估车程 | Snow-Forecast Slug (待确认) |
|---|--------|------|----------|---------------------------|
| 1 | GALA 汤泽 | 新潟 | ~2h | Gala-Yuzawa |
| 2 | 苗场 | 新潟 | ~2.5h | Naeba |
| 3 | 神乐 | 新潟 | ~2.5h | Kagura |
| 4 | 神立高原 | 新潟 | ~2h | Kandatsu-Kogen |
| 5 | 石打丸山 | 新潟 | ~2h | Ishiuchi-Maruyama |
| 6 | 舞子 | 新潟 | ~2h | Maiko |
| 7 | 白马八方尾根 | 长野 | ~3.5h | Happo-One |
| 8 | 白马五竜 | 长野 | ~3.5h | Hakuba-Goryu |
| 9 | 白马47 | 长野 | ~3.5h | Hakuba-47 |
| 10 | 志贺高原·横手山 | 长野 | ~3h | Yokoteyama |
| 11 | 志贺高原·焼額山（奥志贺） | 长野 | ~3h | Okushiga-Kogen |
| 12 | 志贺高原·一の瀬 | 长野 | ~3h | Shiga-Kogen-Ichinose |
| 13 | 野泽温泉 | 长野 | ~3h | Nozawa-Onsen |
| 14 | 草津温泉 | 群马 | ~3h | Kusatsu-Onsen |
| 15 | 丸沼高原 | 群马 | ~2.5h | Marunuma-Kogen |
| 16 | 川場 | 群马 | ~2.5h | Kawaba |
| 17 | 谷川岳天神平 | 群马 | ~2.5h | Tanigawadake-Tenjindaira |
| 18 | 宝台树 | 群马 | ~2.5h | Hodaigi |
| 19 | 嬬恋 | 群马 | ~3h | Tsumagoi |
| 20 | 菅平高原 | 长野 | ~2.5h | Sugadaira-Kogen |
| 21 | 轻井泽 Prince | 长野 | ~2h | Karuizawa |
| 22 | 富士天 | 山梨 | ~1.5h | Fujiten |

---

## 附录 B: 评分示例

**场景**: 2026 年 2 月 15 日（周日）

| 滑雪场 | 新雪(25%) | 天气(20%) | 开放率(15%) | 积雪(10%) | 交通(15%) | 性价比(10%) | 拥挤(5%) | **总分** |
|--------|-----------|-----------|-------------|-----------|-----------|-------------|----------|----------|
| 神乐 | 90 | 75 | 95 | 85 | 70 | 70 | 60 | **80.0** |
| 苗场 | 85 | 70 | 90 | 80 | 75 | 60 | 50 | **75.8** |
| GALA | 60 | 80 | 100 | 70 | 100 | 65 | 40 | **75.0** |

→ **推荐**: 🏆 神乐（新雪充足、开放率高、综合最优）

---

*文档结束。V1 开发预计 4-6 周，建议立即开始数据采集模块验证。*
